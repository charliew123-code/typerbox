const quotes = [['Your','bed','is','with','you','in','the','void.', 'But','not','for','long','-','it','goes','away','from','you.','You','don\'t','have','any','way','to','get','it','back,','so','you','just','let','it','go.','But','so','now','we','have','a','body','in','the','void','with','you.','So','does','the','bed','move,','or','do','you','move?','Or','both?',' '],['Cool,','I','spend','my','time','just','thinkin\'','thinkin\'','thinkin\'','\'bout','you.','Every','single','day','yes,','I\'m','really','missin\'','missin\'','you.','And','all','those','things','we','used','to','used','to','used','to','used','to','do.','Hey','girl,','what\'s','up?','It','used','to','used','to','be','just','me','and','you.',' '],['Mambo','number','five.','Jump','up','and','down','and','move','it','all','around.','Shake','your','head','to','the','sound,','put','your','hand','on','the','ground.','Take','one','step','left','and','one','step','right.','One','to','the','front','and','one','to','the','side.','Clap','your','hands','once','and','clap','your','hands','twice.','And','if','it','looks','like','this,','then','you','are','doing','it','right.',' '],['Let\'s','cross','the','bridge','to','the','other','side.','Just','you','and','I','(just','you','and','I).','I','will','fly','fly','the','skies.','For','you','and','I','(for','you','and','I).','I','will','try','until','I','die','for','you','and','I.','For','you','and','I,','for','for','for','you','and','I.','For','for','for','for','you','and','I,','for','for','you','and','I','(for','you','and','I).',' '],['Man','can','never','be','hot','(never','hot),','perspiration','ting','(spray','dat),','Lynx','Effect','(come','on),','you','didn\'t','hear','me,','did','you?','(nah).','Use','roll-on','(use','that)','or','spray','(shhh),','but','either','way,','A-B-C-D','(alphabet','ting).','The','ting','goes','skrrrahh,','pap,','pap,','ka-ka-ka.','Skidiki-pap-pap,','and','a','pu-pu-pudrrrr-boom.','Skya,','du-du-ku-ku-dun-dun.','Poom,','poom,','you','don\'','know.','Big','Shaq,','man\'s','not','hot.','I','tell','her','man\'s','not','hot','(never','hot),','40','degrees','and','man\'s','not','hot','(come','on).','Yo,','in','the','sauna,','man\'s','not','hot','(never','hot).','Yeah,','skidika-pap-pap.',' '],['Yeah,','I\'m','the','Scatman.','Dong','dong','dong,','ding','ding','dong','dong.','Wo-go-ez-ze-ze-za-de-ya-de-za-de-ya-ze-ze-zee,','dong-ding-dong-dong-dong,','do-dong-ding.','Where\'s','the','Scatman?','Ska-badabadabadoo-belidabbelydabbladabbladabblabab-belibabbelibabbelibabbelabbelo-doobelidoo.','I\'m','the','Scatman,','repeat','after','me.','It\'s','a','scoobie-oobie-doobie,','scoobie-doobie','melody.','I\'m','the','Scatman,','sing','along','with','me.','It\'s','a','scoobie-oobie-doobie,','scoobie-doobie','melody.','Yeah,','I\'m','the','Scatman','(I\'m','the','Scatman).',' '],['The','fall','(bababadalgharaghtakamminarronnkonnbronntonnerronntuonnthunntrovarrhounawnskawntoohoohoordenenthurnuk!)','of','a','once','wallstrait','oldparr','is','retaled','early','in','bed','and','later','on','life','down','through','all','christian','minstrelsy.','The','great','fall','of','the','offwall','entailed','at','such','short','notice','the','pftjschute','of','Finnegan,','erse','solid','man,','that','the','humptyhillhead','of','humself','prumptly','sends','an','unquiring','one','well','to','the','west','in','quest','of','his','tumptytumtoes:','and','their','upturnpikepointandplace','is','at','the','knock','out','in','the','park','where','oranges','have','been','laid','to','rust','upon','the','green','since','devlinsfirst','loved','livvy.',' '],['See','your','girl','next','door.','She','is','nine','years','old.','That','girl','had','a','bobble','when','the','boys','went','eetsawoh,','eh-do-woh.','She','eats','lunch','at','1:30','PM.','Oh,','another','girl!','She','is','wearing','a','dress.','She','is','seven','years','old.','Eh,','waeeeh.','That','means','she','has','a','low','neckline.','Girls','always','wear','dresses','(just','lying,','they','sometimes','wear','dresses),','boys','rarely,','if','ever,','wear','dresses','(they\'re','girly).','We','like','Kayla,','Sophie,','Robin,','Mila,','Emma,','Layla','and','Darla.','All','the','girls','are','in','dresses','(not','all),','so','pretty!','Teenage','girl','weaker','than','me,','13','years','old','and','she\'s','14.','When','the','girl','walked','to','the','right','of','your','house,','you','go','han,','han-da-lon,','han,','hun,','hon-do-len.','Han,','han-da-lon,','han.','Hun,','hon-do-len.','Wen-da-wenna-wen-wen,','wen-da-wenna-wen-wen.','Olalolalolalola,','lolalolalolalola,','you','don\'t','know.',' '],['I','tell','her','she\'s','pretty','(oh,','I','love','you)','25','March','and','girl','wearing','dress.','Girls','wearing','dresses','from','March','to','October,','a','full','8','months','of','girls','wearing','dresses.','I','undo','my','shirt.','I','go','eetsu-u-u-waah.','Aah-tsaah-waah.','For','God\'s','sake,','why','did','you','undo','three','buttons?','Button','it','back','up!','Girl','has','the','top','three','buttons','undone','on','her','shirt.','Other','girl','walked','to','the','right','of','your','house.','Han,','han-da-lon,','han,','hun,','hon-do-len.','Han,','han-da-lon,','han.','Hun,','hon-do-len.','Wen-da-wenna-wen-wen,','wen-da-wenna-wen-wen.','Olalolalolalola,','lolalolalolalola,','you','don\'t','know.','I','talk','to','my','sister.','You','look','so','cute','in','your','dress!','Ah,','thank','you','so','much!','I\'m','so','pretty','in','my','dress!','Boy,','in','the','pink','room,','girls','always','wear','dresses.','Yeah,','wen-da-wen.',' '],['Hey,','what\'s','your','name?','Andre','three','thousand,','the','year','to','fear','is','already','here.','Must','look','beyond,','sounds','from','the','center','of','the','sun.','Reason','for','a','gun,','only','one.','Strong','believer','in','self-preservation.','Aahhhhh,','oof.','In','the','state','of','confused,','city','of','forgotten','fate,','county','of','the','blues.','Street','address,','generation','X','avenue.','But','generation','Y','high','to','the','point','that','I','drink.','Runnin\'','on','a','new','one.','Walkin\'','in','my','silver','boots,','need','a','shoe','horn','and','some','church','socks.','What','if','I','told','you','that','even','if','you','made','clocks','stops,','time','rewinds,','see','what','he','finds,','then','re-arrange','and','change','things','that\'s','on','your','mind,','would','you','swallow','like','fine','wine','or','peanut','butter?','Would','you','holler','that','I\'m','live','and','ask','another?','Or','take','no','heat','and','run','for','cover?','If','it','don\'t','bump','off','in','the','club,','you','can\'t','rock.','If','it','ain\'t','eight','o','eight','in','the','trunk,','it','ain\'t','knock.','If','you','round','our','neck','of','the','woods,','you','better','stop.','\'Cos','the','people','on','the','block','gonna','show','you','where','to','drop,','ahh.',' '],['What','ridiculous','histrioni-ni-ni.......','h-h-histrioni-ni............What','ridiculous','ACTING!!',' '],['Goo','Goo','Dolls.','Foo','Fighters.','Foo','Foo','Dolls.','Goo','Goo','Goo','Dolls.','Goo','Fighters.','Foo','Dolls.','Goo-Foo','Fighters.','Foo-Foo','Dolls','(ah,','yeah!).','Goo','Foo','Goo','Foo','Dolls.','Foo','Foo','Foo','Fighters.','Doll','Fighters.','Fighter','Foos.','Goo','Fighter','Goos.','Foo','Fighter','Goo','Foo','Dolls','Dolls.','Goo','Goo','Dolls','Fighters','Goo','Dolls','Dolls','(dolls,','goo).',' '],['My','typing','speed','on','my','laptop','keyboard','SUCKS.','I','now','type','around','65-70','wpm','fdjkaljdfa','how','do','i','get','used','to','this','and','get','back','to','my','old','typing','speed','pls.',' '],['This','sentence','has','five','words.','Here','are','five','more','words.','Five-word','sentences','are','fine.','But','several','together','become','monotonous.','Listen','to','what','is','happening.','The','sound','of','it','drones.','It\'s','like','a','stuck','record.','The','ear','demands','some','variety.','Now','listen.','I','vary','the','sentence','length,','and','I','create','music.','Music.','The','writing','sings.','It','has','a','pleasant','rhythm,','a','lilt,','a','harmony.','I','use','short','sentences.','And','I','use','sentences','of','medium','length.','And','sometimes,','when','I','am','certain','the','reader','is','rested,','I','will','engage','him','with','a','sentence','of','considerable','length,','a','sentence','that','burns','with','energy','and','builds','with','all','the','impetus','of','a','crescendo,','the','roll','of','the','drums,','the','crash','of','the','cymbals-sounds','that','say','listen','to','this,','it','is','important.',' '],['"Do','you','want','to','go','that','way','or','that','way?"','"That','way."','"But','first,','let\'s','see','what\'s','this','way.','Maybe','it\'ll','give','us','a','better','clue','to','what\'s','the','other','way."','"THAT','WAY,','AAAAAAAAAAAAAAAAAAAAAAAAAAAHHHHHHHHHHHHHHHHHHHHH!!!"',' '],['SoMETIMES...','God','TAKES','MOMMIES','ANd','PuPPIES','AWAY...','ANd','SoMETIMES...','JuST','SoMETIMES..','I','do.',' '],['The','quick','brown','fox','jumps','over','the','lazy','dog.',' '],['When','I','was','a','lad','I','served','a','term','as','office','boy','to','an','attorney\'s','film.','I','cleaned','the','wndows','and','I','swept','the','floor,','and','I','polished','up','the','handle','of','the','big','front','door.','I','polished','up','that','handle','so','carefullee','that','now','I','am','the','Ruler','of','the','Queen\'s','Navee!',' '],['aS','Of','april','2025,','WindOWS','10','dOminateS,','With','54%','Of','the','WindOWS','market','Share.','in','SeCOnd','and','third','plaCe','are','WindOWS','11','With','42%','Of','the','market','Share','and','WindOWS','7,','Which','iS','nOw','unSuppOrted,','With','2%','Of','the','market','Share.',' '],['It\'s','not','about','what','32-bit','app','one','person','wants','to','run.','It\'s','about','all','the','32-bit','apps','that','the','entire','Wndows','ecosystem','wants','to','run.','People','in','nations','you\'ve','barely','even','heard','of.','Banks.','Factories.','Grade','schools.','Scientists.','Governments.','Hospitals.','Militaries.','You','get','the','idea.',' '],['Good','evening,','sportsmen','evewywhere.','Fwesh-Fwied,','Fwesh-Fwozen','Wabbit','Company','bwings','you','The','Sportsman\'s','Hour,','with','handy','hunting','tips','by','yours','twuwy,','Ewmer','Fudd!','And','today','I','have','a','WEAL','surpwise','for','you:','I','will','demonstwate','the','pwoper','pwocedure','for','hunting,','twacking','down','and','bwasting','to','smitheweens','a','weal,','wive','wabbit!','Now,','be','vewy,','vewy','quiet...',' '],['Friday','morning','Qwilleran','sat','at','his','typewriter','and','stared','at','the','row','of','keys','that','spelled','q-w-e-r-t-y-u-i-o-p.',' '],['"Well,','it','used','to','be','a','photocopy','machine,"','said','Melvin,','"but','I\'ve','made','some','major','adjustments','to','it.','Now','it','is','an','invention','that','will','revolutionize','the','world.','I','call','it','the','PATSY','2000."','"It\'ll','revolutionize','the','world,','and','you','named','it','PATSY???"','asked','Harold.','"Yes,"','said','Melvin.','"PATSY','is','an','acronym','for','Photo-Atomic','Trans-Somgobulating','Yectofantriplutoniczanziptomiser."',' '],['von','Karma:','The','murder','weapon...','Where','is','Max\'s','bust','now!?','Phoenix:','It\'s','obvious!','The','bust','is','inside','this','very','courtroom!','Judge:','It\'s...','O-O-Obvious...?','Phoenix:','Allow','me','to','pinpoint','the','location','of','the','bust','once','and','for','all!','It\'s...','Umm...','Umm.................','Judge:','W-W-W-What!?','Why','you','did','you','stop','talking','all','of','a','sudden!?','Phoenix:','Well...','I\'m','just','not','really','sure','if','I','should','say','anything','or','not','because','the','bust','is...','Under','Your','Honor\'s','bench!',' '],['Gruntilda:','Banjo\'s','game','ends','in','my','tower,','turn','it','up','I','need','full','power!','Klungo:','Yesss','your','Gruntyssship,','transssformation','sssoon','be','complete...','Tooty:','Help','me','Banjo,','I','feel','all','funny...','Klungo:','Bear','and','bird','finissshed,','Grunty','winsss!','Gruntilda:','Look','at','Grunty','she\'s','a','beauty,','I\'m','much','prettier','than','Tooty!','Klungo:','Oh','you','are','missstresss!','Mumbo:','Grunty','nice,','come','back','to','Mumbo\'s','skull,','yes?','Tooty:','Banjo!','Your','sister','wants','a','word','with','you...','Now!',' '],['Waiter:','What','is','your','name?','Aladeen:','Allison','Burgers.','Waiter:','That\'s','a','made','up','name.','What\'s','your','real','name?','Aladeen:','Ladiz.','Waiter:','Ladiz','what?','Aladeen:','Ladiz','Washroom.','Waiter:','So','your','name','is','like','the','sign.','Ladies','washroom?','That','is','a','made','up','name,','what','is','your','real','name?','I','am','interested.','We','are','interested.','Aladeen:','Emplyes.','Waiter:','Emplyes','what!?','Aladeen:','Emplyes','Mustwashhands.','Waiter:','That','is','a','made','up','name.','What','is','your','real','name?','Aladeen:','Max.','Waiter:','Max','what?','Aladeen:','Imumoccupancy120.','Waiter:','There\'s','a','number','in','the','name?','WHO','ARE','YOU!?',' '],['Something','is','written','in','archaic','script.','I','will','translate...','R...o...i...h...c...l...e...m?','Roihclem?','System','error!','I','reversed','it!','It','says','"Melchior!"',' '],['Has','this','ever','happened','to','you?','From','today','dialing','999','won\'t','get','you','the','emergency','services.','And','that\'s','not','the','only','thing','that\'s','changing,','nicer','ambulances,','faster','response','times,','and','better','looking','drivers;','meaning','they\'re','not','the','new','emergency','services,','they\'re','your','emergency','services.','So','remember','the','new','number.','0118-999-88199-9119725...3.','That\'s','0118-999-88199-9119725...3.','Hello,','I\'ve','had','a','bit','of','a','tumble.','Well','that\'s','easy','to','remember!','0118-999-88199-9119725...3.',' '],['Millze','cillzan','sillzome','plilzay','dilzzouble','dilzutch','(hilzzoo?)','My','gizzirl','(brillzing','her','izzin).','Izzo','kizzay','(izzall','rizzight),','izzo','kizzay','(izzall','rizzight).','Nizzow','wizzee','wilzzo-izzo-zee.',' '],['Come','on!','Is','it','worth','it?','Let','me','work','it.','I','put','my','thang','down,','flip','it','and','reverse','it.','Ti','esrever','dna','ti','pilf','nwod','gnaht','ym','tup','i.',' '],['Wndows','10','s','sx','months','aWay','from','ts','end','of','support.','people','are','realsng','that','they','need','to','upgrade','to','Wndows','11','before','oKKKtober','of','2025.','many','pKKKs','are','nKKKapable','of','upgradng','to','Wndows','11,','KKKommonly','beKKKause','of','one','of','tWo','reasons:','tpm','2.0','s','not','enabled','on','ther','pKKK,','or','the','proKKKessor','s','not','supported','for','Wndows','11.','ths','leaves','400','mllon','users','at','rsk.',' '],['Type','the','above','text','here','when','the','race','begins.',' '],['Monkeytype','is','a','minimalistic','and','customizable','typing','test.','It','features','many','test','modes,','an','account','system','to','save','your','typing','speed','history,','and','user-configurable','features','such','as','themes,','sounds,','a','smooth','caret,','and','more.','Monkeytype','attempts','to','emulate','the','experience','of','natural','keyboard','typing','during','a','typing','test,','by','unobtrusively','presenting','the','text','prompts','and','displaying','typed','characters','in-place,','providing','straightforward,','real-time','feedback','on','typos,','speed,','and','accuracy.',' '],['Activate','Windows.','Go','to','Settings','to','activate','Windows.',' '],['Something','is','written','on','the','girl\'s','jacket.','I','will','read...','Z-Za-Zave...C-Ca-Canada?','Zave','Canada?','System','error!','It\'s','upside','down!','It','says','"epeuec','a^ez!".',' '],['I\'m','gripping','these','curbs.','Skrrt,','did','ya','heard?','I','love','\'em,','my','feathers,','my','furs,','ah.','I','fly','like','a','bird.',' '],['I','need','my','drums,','bass,','high-hat,','has','to','be','my','snare,','strings,','horns,','yes.','I','need','my','Tim\',','sound,','right,','left.','Izzy','kizzy,','looky','here.',' '],['Sing','now','(oh-whoa-oh).','The','time','is','right','now','for','everyone','to','be','happy.','Sing','now','(oh-whoa-oh).','The','time','is','right','now','for','everyone','to','be','happy.','Ski-bi-dibby-da-ba-da-ba-da-ba-da-ba-da-ba-da-ba-dub,','yeah,','di-di-du-dur-di-di-du-dur-di-di-du-dur-di-di-du-dur,','oh','yeah!','Ski-bi-dibby-da-ba-da-ba-da-ba-da-ba-da-ba-da-ba-dub,','yeah,','di-di-du-dur-di-di-du-dur-di-di-du-dur-di-di-du-dur-bop-di-di-du-dur-bop-di-di-du-dur-bop.','Maybe','we','should','stop','pretending','and','start','believing','dreams','come','true.','The','story','has','a','happy','ending.','It','all','depends','on','me','and','you.','This','is','the','sunrise.','It\'s','the','beginning','of','the','dawn.','Gotta','believe','me.','Believe','in','the','sun.',' '],['I\'m','calling','out','from','Scatland.','I\'m','calling','out','from','Scatman\'s','World.','If','you','wanna','break','free,','you\'d','better','listen','to','me.','You\'ve','got','to','learn','how','to','see,','in','your','fantasy.','Ski-bi-debeh-dopabodidingdickidi,','dingdingdingdi-ding-bopdopidi,','bi-di-di-di-ding-bopdopidi,','dalalalalalalalalala-bippidibi,','bi-twee-dada-twee-dada-deedle-dada-dadada,','dadadadadadadadadadada-de,','bopadopa-dobadopa-dobadopa-da.','Hey,','yeah!',' '],['I\'m','calling','out','from','Scatland','(ba','boppito,','ba','ba','ba,','ba','boppity).','I\'m','calling','out','from','Scatman\'s','World.','If','you','wanna','break','free','you','better','listen','to','me.','You\'ve','got','to','learn','how','to','see','in','your','fantasy.','Skibi-debida-bide-bidep,','listen','to','me!','I\'m','calling','out','from','Scatland','(bopbopahdop-bababa-ba-babedi).','I\'m','calling','out','from','Scatman\'s','World','(bopbopahdop-bababa-bee-babedi).','If','you','wanna','break','free','you','better','listen','to','me.','You\'ve','got','to','learn','how','to','see','in','your','fantasy.','Di-ding-doogadungdadingdoodung,','doodungdadingdadingduhduhdungdughdugh','(bopbopahdop-bababa-ba-babedi).',' '],['Cock-a-doodle-doo!','I\'m','calling,','I\'m','calling','(trrr).','Calling','on','you','to','say','I','want','you,','I','want','you.','Maybe','all','night,','till','day,','I','want','you,','I','want','you.','Different','towns','to','run','to.','Baby','come','to','me,','ha-ha-ha.','Give','it','all','to','me.','Skibidi','ua-papa,','skibidi','ua-papa-papa,','skibidi','ua-papa-papa-papa-papa,','skibidi','papa,','skibidi','boom-boom,','ay,','skibidi','boom-boom-boom-boom,','ay,','skibidi','boom-boom-boom-boom-boom-papa-boom-boom,','skibidi','papa.','Ay!','Ay!',' '],['For','example,','in','Year','1','that','useless','letter','"c"','would','be','dropped','to','be','replased','either','by','"k"','or','"s",','and','likewise','"x"','would','no','longer','be','part','of','the','alphabet.','The','only','kase','in','which','"c"','would','be','retained','would','be','the','"ch"','formation,','which','will','be','dealt','with','later.','Year','2','might','reform','"w"','spelling,','so','that','"which"','and','"one"','would','take','the','same','konsonant,','wile','Year','3','might','well','abolish','"y"','replasing','it','with','"i"','and','Iear','4','might','fiks','the','"g/j"','anomali','wonse','and','for','all.','Jenerally,','then,','the','improvement','would','kontinue','iear','bai','iear','with','Iear','5','doing','awai','with','useless','double','konsonants,','and','Iears','6-12','or','so','modifaiing','vowlz','and','the','rimeining','voist','and','unvoist','konsonants.','Bai','Iear','15','or','sou,','it','wud','fainali','bi','posibl','tu','meik','ius','ov','thi','ridandant','letez','"c",','"y"','and','"x"','-','bai','now','jast','a','memori','in','the','maindz','ov','ould','doderez','-','tu','riplais','"ch",','"sh",','and','"th"','rispektivli.','Fainali,','xen,','aafte','sam','20','iers','ov','orxogrefkl','riform,','wi','wud','hev','a','lojikl,','kohirnt','speling','in','ius','xrewawt','xe','Ingliy-spiking','werld.',' '],['(this','girl','is)','She\'s','stuck','on','my','ele,','eh-el-eh-vator','(frikki','frikki).',' '],['Young','Mula,','baby!','Let','me','see.','Haha,','you','thought','it','was','over?','Let','me','see.','I','wasn\'t','born','last','night.',' '],['Girl,','I','travel','\'round','the','world','and','even','sail','the','seven','seas,','across','the','universe','and','all','the','other','galaxies.','Just','tell','me','where','to','go,','just','tell','me','where','you','wanna','meet.','I','navigate','myself','myself','to','take','me','where','you','be.','\'Cause,','girl,','I','want,','I,','I,','I','want','you','right','now.','I','travel','uptown','town,','I','travel','downtown.','Wanna','have','you','around,','\'round','like','every','single','day.','I','love','you','always','ways.','I\'ll','meet','you','halfway.',' '],
               ['Mila:','"that\'s','the','3rd','time','this','month”','Sayori:','"hiii','fren...','i','need','a','little','help','here...','please?"',' ']];
const sources = ['Teach the Short Words First','Black Eyed Peas - Meet Me Halfway','Mambo No. 5','Black Eyed Peas - Meet Me Halfway','Man\'s Not Hot','Scatman (Ski-Ba-Bop-Ba-Dop-Bop)','Finnegans Wake','Girls quote','Girls quote','Neck uv da Woods','Looney Tunes','Possible Band Names','How to adjust to a new keyboard?','Unknown','Bad dream','California Speed','Illustrative Shorthand','W. S. Gilbert','Unknown','Zeusifer - How Long Until Windows Completely Drops 32-bit Support (No More WoW64)?','Looney Tunes','The Cat Who Could Read Backwards','Captain Underpants and the Attack of the Taking Toilets','Phoenix Wright: Ace Attorney - Justice for All','Banjo-Kazooie','The Dictator','Chrono Trigger','The IT Crowd','Gossip Folks','Work It','Unknown','TypeRacer','Monkeytype','Windows 10','Unknown','Gossip Folks','Gossip Folks','Sing Now!','Scatman\'s World','Scatman\'s World','Skibidi','Mark Twain','Flo Rida - Elevator','Chris Brown - Loyal','Meet Me Halfway',
                'Mila and sayori'];
console.log(quotes.length + "quotes in total");
const e = Math.floor(Math.random()*quotes.length);
const wordList = quotes[e];
const source = sources[e];
const amountOfWords = wordList.length-1;
let wordIndex = 0;

function capitalizeFirstLetter(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

// jQuery like selection of elements.
window.$ = document.querySelectorAll.bind(document);

// Knuth-Fisher-Yates Shuffle
// http://bost.ocks.org/mike/shuffle/
function shuffle(array) {
  let m = array.length,
      t,
      i;

  while (m) {
    // Pick a remaining element…
    i = Math.floor(Math.random() * m--); // And swap it with the current element.

    t = array[m];
    array[m] = array[i];
    array[i] = t;
  }

  return array;
}


// Add words to word-section
function addWords() {
  // Clear existing word-section
  const wordSection = window.$("#word-section")[0];
  wordSection.innerHTML = "";
  window.$("#typebox")[0].value = "";
  let p = 0;
  let wordSpan;
  let wordToType;

  for (let i = amountOfWords+1; i > 0; i--) {
    wordToType = wordList[p]
    wordSpan = `<span>${wordToType}</span>`
    wordSection.innerHTML += wordSpan;
    p++;
    if (p >= wordList.length) {
      p = 0;
    }
  }

  // Mark first word as current-word
  wordSection.firstChild.classList.add("current-word");
}

// Word Colors
const colorCurrentWord = "#dddddd";
const colorCorrectWord = "#93C572";
const colorIncorrectWord = "#e50000";

// Word Count and other data.
const wordData = {
  seconds: 1,
  correct: 0,
  incorrect: 0,
  total: 0,
  typed: 0
};
let seconds2 = 0;

function checkWord(word) {
  const wlen = word.value.length;
  const wval = word.value.split(' ')[0].trim();

  // How much we have of the current word.
  const current = window.$(".current-word")[0];
  const currentSubstring = current.innerHTML.substring(0, wlen);

  // Check if we have any typing errors and make sure there is a real
  // word to check https://github.com/anschwa/typing-test/issues/2
  const noMatch = wval !== currentSubstring;
  const emptyWords = wval === '' || currentSubstring === '';

  if (noMatch || emptyWords) {
    current.classList.add("incorrect-word-bg");
    return false;
  } else {
    current.classList.remove("incorrect-word-bg");
    return true;
  }
}

function submitWord(word) {
  // Update current-word and keep track of correct & incorrect words
  const current = window.$(".current-word")[0];

  if (checkWord(word)) {
    current.classList.remove("current-word");
    current.classList.add("correct-word-c");
    wordData.correct += 1;
    wordIndex++;
  } else {
    current.classList.remove("current-word", "incorrect-word-bg");
    current.classList.add("incorrect-word-c");
    wordData.incorrect += 1;
    wordIndex++;
  }

  // Update wordData
  wordData.total = wordData.correct + wordData.incorrect;

  // Make the next word the new current-word.
  current.nextSibling.classList.add("current-word");
}

function clearLine() {
  // Remove past words once you get to the next line
  const wordSection = window.$("#word-section")[0];
  const current = window.$(".current-word")[0];
  const previous = current.previousSibling;
  const children = window.$(".correct-word-c, .incorrect-word-c").length;

  // <span>'s on the next line have a greater offsetTop value than
  // those on the top line. Remove words until the first word on the
  // second line is the fistChild of word-section.
  if (current.offsetTop > previous.offsetTop) {
    for (let i = 0; i < 0; i++) {
      wordSection.removeChild(wordSection.firstChild);
    }
  }
}

let typingTimer = null;
function isTimer(seconds) {
  // BUG: page refresh with keyboard triggers onkeyup and starts timer
  const time = window.$("#timer > span")[0].innerHTML;
  if (time === `${amountOfWords}/${amountOfWords}`) {
    return false;
  }

  // Only set timer once
  if (time === "" && typingTimer === null) {
    typingTimer = window.setInterval(() => {
      if (seconds <= 0) {
        window.clearInterval(typingTimer);
      } else {
        
        const timePad = seconds < 10 ? "0" + seconds : seconds; // Zero padded

        window.$("#timer > span")[0].innerHTML = `${wordIndex}/${amountOfWords}`;
      }
      seconds2 = seconds2 + 0.01;
    }, 10);
  }

  return true;
}

let backspaces = 0;

function calculateWPM(data) {
  const { seconds, correct, incorrect, total, typed } = data;
  const minutes = seconds2 / 60;
  const wpm = Math.max(0, Math.ceil(((typed / 5) - incorrect) / minutes));
  const rawWpm = Math.max(0, Math.ceil(((typed / 5) ) / minutes));
  const accuracy = Math.floor(typed / (typed+backspaces)*100*100)/100

  const results = `
<ul id="results">
  <li>WPM: <span class="wpm-value">${wpm}</span></li>
  <li>Accuracy: <span class="wpm-value">${accuracy}%</span></li>
  <li id="results-stats">
    Total Words: <span>${total}</span> | 
    Characters Typed: <span>${typed}</span> | Time: <span>${Math.floor(seconds2/60)}:${seconds2-Math.floor(seconds2/60)*60} | Points: ${Math.floor(wpm*accuracy*seconds2)}</span><br>Quote source: ${source}    
  </li>
</ul>
`;

  window.$("#word-section")[0].innerHTML = results;

  // Color-code accuracy
  const wpmClass = window.$("li:nth-child(2) .wpm-value")[0].classList;
  if (accuracy > 80) {
    wpmClass.add("correct-word-c");
  } else {
    wpmClass.add("incorrect-word-c");
  }

  console.log(wordData);
}

function typingTest(e) {
  const SPACE = 32;
  const BACKSPACE = 8;

  // Get key code of current key pressed.
  e = e || window.event;
  const kcode = e.keyCode;
  const word = window.$("#typebox")[0];

  // Check if empty (starts with space)
  if (word.value.match(/^\s/g)) {
    word.value = "";
    return;
  }

  // Display typing test results when timer runs out.
  const isGameover = !isTimer(wordData.seconds);
  if (isGameover) {
    calculateWPM(wordData);
    return;
  }

  // Otherwise, keep score when timer is on.
  checkWord(word);
  if (kcode === SPACE && checkWord(word)) {
    submitWord(word);
    clearLine();

    field = window.$("#typebox")[0].value
    window.$("#typebox")[0].value = field.slice(field.indexOf(' ')).trim()
  }
  if (kcode === BACKSPACE) {
    backspaces++;
  }

  wordData.typed += 1;
}

function restartTest() {
  window.$("#typebox")[0].value = "";
  window.location.reload();
}
